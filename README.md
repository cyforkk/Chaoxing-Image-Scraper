# CyForkk - 学习通图片爬取工具

一个简单易用的学习通课程图片爬取工具，提供图形化界面，支持课程图片和作业图片两种爬取模式。

主要是爬取课程中，不能一下下载的pdf文件，到学习通只有一张张图片，另存为太麻烦了；第二个就是借鉴同学的作业图片可以爬取（第二个功能，默认是爬取课程图片）。

支持自动获取Cookie，未输入时自动提示获取，Cookie失效时自动重新获取，极大简化操作流程。

/dist文件夹下有exe文件，可直接运行
## 功能特性

- 🖼️ 自动爬取学习通课程中的图片
- 📝 支持爬取作业答案图片
- 📁 智能命名：
  - 课程图片：课程名-章节名-第X题-Y.jpg
  - 作业图片：课程名-题目名-序号.jpg
- 🖥️ 精美的图形化界面
- 🤖 智能Cookie管理：
  - 自动检测Cookie状态
  - 未输入时自动提示获取
  - Cookie失效时自动重新获取
  - 一键自动获取（无需手动复制）
- 🔒 Cookie持久化存储
- 📊 详细的日志输出和下载统计
- 💾 自动保存到桌面 images 文件夹
- 🎨 现代化UI设计

## 快速开始

### 下载使用

1. 下载 `学习通图片爬取工具.exe`
2. 双击运行程序
3. 按照界面提示操作

### 使用步骤

#### 方式一：智能自动获取Cookie（推荐）⭐

1. 输入课程链接
2. 选择爬取模式（课程图片/作业图片）
3. 点击 **🚀 开始爬取**
4. 如果未检测到Cookie，程序会自动提示是否打开浏览器获取
5. 在弹出的浏览器中登录学习通
6. 登录成功后，Cookie会自动填充并开始爬取

#### 方式二：手动获取Cookie

1. 点击Cookie区域的 **🤖 自动** 按钮
2. 在弹出的浏览器中登录学习通
3. 登录成功后，Cookie会自动填充
4. 输入课程链接并选择爬取模式
5. 点击 **🚀 开始爬取**

#### 方式三：手动输入Cookie

1. 登录学习通网站
2. 按F12打开开发者工具
3. 在Console输入 `document.cookie` 并复制
4. 粘贴到程序的Cookie输入框
5. 输入课程链接
6. 选择爬取模式
7. 点击 **🚀 开始爬取**

## 两种爬取模式

### 📚 课程图片模式

- 爬取课程章节中的PDF文档图片
- 按题目分组，每个`<p>`标签为一道题
- 文件命名：`课程名-章节名-第1题-1.jpg`
- 适合：课程资料、课件、习题等

**示例：**
```
数学-第一章-第1题-1.jpg
数学-第一章-第1题-2.jpg
数学-第一章-第2题-1.jpg
```

### 📝 作业图片模式

- 爬取作业答案区域的图片
- 自动提取作业标题作为文件名
- 文件命名：`课程名-题目名-序号.jpg`
- 适合：作业答案、实验报告等

**示例：**
```
通信原理-实验3 基带编译码——AMI-HDB3-CMI码-1.jpg
通信原理-实验3 基带编译码——AMI-HDB3-CMI码-2.jpg
```

## 界面说明

### 主界面功能

1. **课程链接**：输入学习通课程或作业的URL
2. **Cookie区域**：
   - 🤖 自动：一键自动获取Cookie
   - 🗑️ 清空：清空Cookie输入框
3. **下载目录**：选择图片保存位置（默认：桌面/images）
4. **爬取模式**：
   - 📚 课程图片：爬取课程章节图片
   - 📝 作业图片：爬取作业答案图片
5. **操作按钮**：
   - 🚀 开始爬取：开始下载图片
   - 🗑️ 清空日志：清空日志显示
   - 💾 保存设置：保存当前配置

### 智能Cookie管理说明

#### 自动检测与提示

当您点击 **🚀 开始爬取** 时：
- 如果未输入Cookie，程序会自动弹窗询问是否获取
- 如果Cookie已失效，程序会自动重新获取
- 无需手动操作，智能化处理

#### 手动获取Cookie

点击 **🤖 自动** 按钮后：

1. 程序会自动打开Chrome浏览器
2. 跳转到学习通登录页面
3. 在浏览器中完成登录
4. 登录成功后，程序自动检测并获取Cookie
5. Cookie自动填充到输入框
6. 浏览器自动关闭

**注意：**
- 需要安装Chrome浏览器
- 如果已登录学习通，会立即获取Cookie
- 超时时间：5分钟

## 如何获取课程链接

### 课程图片链接

1. 登录学习通
2. 进入课程
3. 点击要爬取的章节
4. 复制浏览器地址栏的URL

**链接格式：**
```
https://mooc1.chaoxing.com/mycourse/studentstudy?chapterId=xxx&courseId=xxx&clazzid=xxx...
```

### 作业图片链接

1. 登录学习通
2. 进入作业页面
3. 复制浏览器地址栏的URL

**链接格式：**
```
https://mooc1.chaoxing.com/mooc2/work/view?...
```

## 系统要求

- **操作系统**：Windows 10/11
- **浏览器**：Chrome（用于自动获取Cookie）
- **网络**：需要联网访问学习通

## 常见问题

**Q: 没有输入Cookie可以直接爬取吗？**

A: 可以！点击"开始爬取"后，程序会自动提示您获取Cookie，非常方便。

**Q: 自动获取Cookie失败？**

A: 确保已安装Chrome浏览器，或使用手动输入Cookie方式。

**Q: 下载的图片是空的或404？**

A: Cookie可能过期，程序会自动检测并重新获取Cookie。

**Q: 找不到图片？**

A: 确保课程链接正确，且该章节包含可查看的文档或作业答案。

**Q: 如何区分课程图片和作业图片？**

A: 
- 课程图片：选择"📚 课程图片"，用于爬取课程章节中的PDF文档
- 作业图片：选择"📝 作业图片"，用于爬取作业答案区域的图片

**Q: Cookie会自动保存吗？**

A: 是的，Cookie会自动保存，下次启动程序会自动加载。

**Q: 图片保存在哪里？**

A: 默认保存在桌面的 `images` 文件夹，可以在"下载目录"中修改。

**Q: 为什么课程图片按题号命名？**

A: 程序会识别每个`<p>`标签为一道题，方便按题目整理图片。

**Q: 作业图片的题目名称从哪里来？**

A: 自动从作业页面的标题（`mark_title`）提取，如"实验3 基带编译码——AMI-HDB3-CMI码"。

## 注意事项

⚠️ **重要提醒：**

- Cookie包含敏感信息，请勿泄露给他人
- Cookie可能过期，如无法爬取请重新获取
- 不要频繁爬取，避免给服务器造成压力
- 仅用于个人学习，请勿用于商业用途
- 图片默认保存到桌面 `images` 文件夹
- 程序需要联网才能使用

🚀 **性能优化建议：**

- 将EXE添加到Windows Defender白名单，启动速度提升50-70%
- 放在SSD上运行，启动更快
- 首次运行可能较慢，是杀毒软件扫描导致

## 技术特性

- 智能识别课程图片的题目结构
- 自动提取作业标题作为文件名
- Cookie自动验证和持久化
- 多线程下载，界面不卡顿
- 详细的日志输出
- 现代化的UI设计
- 极速启动：优化后1-2秒启动（添加白名单后0.5-1秒）

## 更新日志

### v1.2
- 🔧 修复EXE打包后浏览器自动关闭问题
- 🌐 新增智能浏览器打开：有Cookie无链接时可直接打开学习通
- ⚡ 优化线程管理，提升稳定性
- 🚀 优化启动速度：排除无用模块，启用strip选项
- 📦 优化打包体积：从45MB减少到26MB

### v1.1
- 🚀 智能Cookie管理：未输入时自动提示获取
- 🔄 Cookie失效自动重新获取
- ⚡ 优化用户体验，减少手动操作

### v1.0
- ✨ 图形化界面
- 🤖 一键自动获取Cookie
- 📚 支持课程图片爬取（按题号分组）
- 📝 支持作业图片爬取（智能命名）
- 💾 Cookie持久化存储
- 🎨 精美的UI设计

## 许可证

MIT License

## 免责声明

本工具仅供学习交流使用，请勿用于非法用途。使用本工具所产生的一切后果由使用者自行承担。

## 联系方式

如有问题或建议，欢迎反馈。

---

**Made with ❤️ by CyForkk**
